# Contexto do Projeto MovimentaIF

## üìå Vis√£o Geral

O **MovimentaIF** √© um sistema completo de gest√£o digital para a academia do IFRS Campus Porto Alegre, desenvolvido como Trabalho de Conclus√£o de Curso (TCC). O projeto consiste em tr√™s m√≥dulos integrados que trabalham em conjunto para modernizar a administra√ß√£o da academia.

## üèóÔ∏è Arquitetura do Sistema

### Estrutura de M√≥dulos

```
MovimentaIF/
‚îú‚îÄ‚îÄ MovimentaIF-API/          # Backend - API REST Spring Boot
‚îú‚îÄ‚îÄ MovimentaIF-Admin/        # Frontend Web - Painel Administrativo
‚îî‚îÄ‚îÄ MovimentaIFApp/           # App Android - Aplicativo Mobile
```

## üéØ Objetivos do Sistema

1. **Digitalizar o gerenciamento** de alunos, professores e treinos
2. **Facilitar o acompanhamento** da evolu√ß√£o f√≠sica dos alunos
3. **Otimizar agendamentos** de hor√°rios na academia
4. **Centralizar dados** em plataforma cloud segura (Firebase)
5. **Permitir acesso m√≥vel** √†s informa√ß√µes de treino para alunos

## üîß Stack Tecnol√≥gico

### Backend (MovimentaIF-API)
- **Framework**: Spring Boot 3.5.4
- **Linguagem**: Java 17
- **Banco de Dados**: Firebase Firestore (NoSQL)
- **Autentica√ß√£o**: Firebase Authentication + JWT OAuth2
- **Seguran√ßa**: Spring Security com Resource Server
- **Build Tool**: Maven
- **Hosting**: Heroku
- **Padr√£o**: RESTful API

### Frontend Web (MovimentaIF-Admin)
- **Tecnologias**: HTML5, CSS3, JavaScript (Vanilla)
- **Framework CSS**: Bootstrap 5
- **√çcones**: Font Awesome
- **Autentica√ß√£o**: Firebase SDK (Web)
- **Comunica√ß√£o**: Fetch API / Axios
- **Hosting**: Cloudflare Pages / Vercel / Netlify

### Mobile (MovimentaIFApp)
- **Linguagem**: Kotlin
- **Plataforma**: Android (API 24+)
- **Arquitetura**: MVVM (Model-View-ViewModel)
- **Navega√ß√£o**: Navigation Components
- **HTTP Client**: Retrofit
- **Ass√≠ncrono**: Kotlin Coroutines
- **Autentica√ß√£o**: Firebase Auth + Google Sign-In
- **UI**: Material Design 3

## üìä Modelo de Dados (Firebase Firestore)

### Entidades Principais

#### 1. **User** (Usu√°rio)
```
- userId: String (PK, UUID)
- userName: String
- email: String (√∫nico)
- age: Date
- phoneNumber: String
- role: String (USER, ADMIN)
- createdAt: Date
- isActive: Boolean
- affiliationType: String (STUDENT, PROFESSOR, STAFF)
- interviewed: Boolean
- didFirstWorkout: Boolean
- scheduledFirstWorkout: Boolean
- isAppUser: Boolean
- firstWorkoutDate: Date
- signedTermOfCommitment: Boolean
- workoutChartId: String (FK)
- isAdmin: Boolean
```

#### 2. **Workout** (Exerc√≠cio)
```
- workoutId: String (PK, UUID)
- workoutName: String
- workoutDescription: String
- workoutVideoLink: String (URL do YouTube)
```

#### 3. **WorkoutChart** (Ficha de Treino)
```
- chartId: String (PK, UUID)
- userId: String (FK)
- mondayWorkouts: List<String> (IDs dos exerc√≠cios)
- tuesdayWorkouts: List<String>
- wednesdayWorkouts: List<String>
- thursdayWorkouts: List<String>
- fridayWorkouts: List<String>
- startDate: Date
- endDate: Date
```

#### 4. **UserWorkout** (Exerc√≠cio Personalizado do Usu√°rio)
```
- userWorkoutId: String (PK, UUID)
- userId: String (FK)
- workoutId: String (FK)
- repetitions: Integer
- weight: Integer (kg)
- series: Integer
- obs: String (observa√ß√µes)
```

#### 5. **WorkoutHistory** (Hist√≥rico de Treinos)
```
- historyId: String (PK, UUID)
- userId: String (FK)
- workoutCharts: List<WorkoutChart> (fichas antigas)
```

## üîê Fluxo de Autentica√ß√£o

1. **Login**: Usu√°rio faz login via Firebase Authentication (Web/Mobile)
2. **Token**: Firebase gera token JWT ap√≥s autentica√ß√£o bem-sucedida
3. **Requisi√ß√£o**: Cliente envia token no header `Authorization: Bearer <token>`
4. **Valida√ß√£o**: Spring Security valida token com Firebase
5. **Autoriza√ß√£o**: API verifica permiss√µes e autoriza acesso
6. **Resposta**: API retorna dados do Firestore

## üåê Endpoints da API

### P√∫blicos (sem autentica√ß√£o)
- `POST /api/users` - Criar novo usu√°rio
- `GET /api/health` - Status da API
- `GET /api/` - Informa√ß√µes gerais

### Protegidos (requerem JWT)
- **Usu√°rios**: `/api/users/*`
- **Exerc√≠cios**: `/api/workouts/*`
- **Fichas**: `/api/workout-charts/*`
- **Hist√≥rico**: `/api/workout-history/*`
- **Configura√ß√µes**: `/api/user-workouts/*`

## üîÑ Fluxo de Dados T√≠pico

### Exemplo: Professor cria ficha de treino para aluno

1. **Web Admin**: Professor faz login (Firebase Auth)
2. **Token JWT**: Frontend obt√©m token do Firebase
3. **Sele√ß√£o**: Professor seleciona aluno e exerc√≠cios
4. **POST Request**: Envia para `/api/workout-charts` com token
5. **Valida√ß√£o**: API valida token e permiss√µes
6. **Firestore**: API salva ficha no Firestore
7. **Atualiza√ß√£o**: User recebe `workoutChartId` atualizado
8. **Mobile**: Aluno v√™ nova ficha no app instantaneamente

## üé® Padr√µes de Projeto Utilizados

### Backend
- **Repository Pattern**: Acesso aos dados via Services
- **DTO Pattern**: Transfer√™ncia de dados entre camadas
- **Dependency Injection**: Gerenciado pelo Spring
- **RESTful**: Arquitetura de API
- **OAuth2 Resource Server**: Valida√ß√£o de tokens

### Mobile
- **MVVM**: Separa√ß√£o de l√≥gica de neg√≥cio e UI
- **Repository Pattern**: Camada de dados
- **LiveData/StateFlow**: Observa√ß√£o de dados reativos
- **Single Activity**: Navega√ß√£o com Navigation Component

## üìù Regras de Neg√≥cio Importantes

1. **Novo usu√°rio** sempre criado como `isActive = false`
2. **Apenas admins** podem ativar usu√°rios
3. **Um usu√°rio** pode ter apenas **uma ficha ativa** por vez
4. **Fichas antigas** s√£o movidas para `WorkoutHistory`
5. **Exerc√≠cios** s√£o compartilhados entre todos os usu√°rios
6. **Configura√ß√µes de exerc√≠cios** (peso, repeti√ß√µes) s√£o **individuais**
7. **Tokens JWT** expiram em 1 hora (renovar automaticamente)
8. **CORS** configurado para permitir apenas dom√≠nios autorizados

## üöÄ Ambientes

### Desenvolvimento
- **API Local**: `http://localhost:8080`
- **Web Local**: `http://localhost:5500` ou Live Server
- **Firebase**: Projeto de desenvolvimento

### Produ√ß√£o
- **API**: `https://movimentaif-api-7895a5f0638f.herokuapp.com`
- **Web Admin**: `https://movimentaif-admin.pages.dev` (ou similar)
- **Firebase**: Projeto de produ√ß√£o
- **App**: Google Play Store (futuro)

## üîß Configura√ß√£o de Vari√°veis de Ambiente

### API (application.properties)
```properties
firebase.admin.credentials=${FIREBASE_CREDENTIALS}
firebase.database.url=${FIREBASE_DATABASE_URL}
spring.security.oauth2.resourceserver.jwt.issuer-uri=${JWT_ISSUER_URI}
server.port=${PORT:8080}
```

### Necess√°rias no Heroku
- `FIREBASE_CREDENTIALS` - JSON completo da chave privada
- `FIREBASE_DATABASE_URL` - URL do Realtime Database
- `JWT_ISSUER_URI` - `https://securetoken.google.com/{project-id}`
- `PORT` - Definido automaticamente pelo Heroku

## üì¶ Estrutura de Pastas da API

```
MovimentaIF-API/
‚îú‚îÄ‚îÄ src/main/java/com/ifrs/movimentaif/movimentaifapi/
‚îÇ   ‚îú‚îÄ‚îÄ config/              # Configura√ß√µes (Firebase, Security)
‚îÇ   ‚îú‚îÄ‚îÄ controller/          # Endpoints REST
‚îÇ   ‚îú‚îÄ‚îÄ dto/                 # Data Transfer Objects
‚îÇ   ‚îú‚îÄ‚îÄ model/               # Entidades do dom√≠nio
‚îÇ   ‚îú‚îÄ‚îÄ service/             # L√≥gica de neg√≥cio
‚îÇ   ‚îî‚îÄ‚îÄ MovimentaIfApiApplication.java
‚îú‚îÄ‚îÄ src/main/resources/
‚îÇ   ‚îî‚îÄ‚îÄ application.properties
‚îú‚îÄ‚îÄ Procfile                 # Heroku deploy config
‚îú‚îÄ‚îÄ system.properties        # Java version
‚îî‚îÄ‚îÄ pom.xml                  # Maven dependencies
```

## üéØ Casos de Uso Principais

### Para Administradores (Web)
1. Cadastrar novos alunos
2. Criar e gerenciar exerc√≠cios
3. Montar fichas de treino personalizadas
4. Acompanhar evolu√ß√£o dos alunos
5. Gerenciar agendamentos
6. Aprovar/desativar usu√°rios

### Para Alunos (Mobile)
1. Visualizar ficha de treino atual
2. Ver detalhes de cada exerc√≠cio (com v√≠deo)
3. Registrar execu√ß√£o de treinos
4. Acompanhar pr√≥prio hist√≥rico
5. Consultar agenda da academia
6. Receber notifica√ß√µes

## üêõ Tratamento de Erros

### API Response Patterns
```json
// Sucesso
{
  "data": { ... },
  "status": "success"
}

// Erro
{
  "error": "Mensagem de erro",
  "status": "error",
  "code": 400
}
```

### HTTP Status Codes Usados
- `200 OK` - Sucesso
- `201 Created` - Recurso criado
- `400 Bad Request` - Dados inv√°lidos
- `401 Unauthorized` - N√£o autenticado
- `403 Forbidden` - Sem permiss√£o
- `404 Not Found` - Recurso n√£o encontrado
- `500 Internal Server Error` - Erro no servidor

## üîí Seguran√ßa

### Implementa√ß√µes
- ‚úÖ HTTPS obrigat√≥rio em produ√ß√£o
- ‚úÖ CORS configurado para dom√≠nios espec√≠ficos
- ‚úÖ Tokens JWT validados em cada requisi√ß√£o
- ‚úÖ Credenciais nunca expostas no c√≥digo
- ‚úÖ Vari√°veis de ambiente para dados sens√≠veis
- ‚úÖ Firebase Rules configuradas no Firestore
- ‚úÖ Rate limiting via Heroku

### Boas Pr√°ticas
- Nunca commitar `.env` ou chaves privadas
- Rotacionar tokens periodicamente
- Validar inputs no cliente e servidor
- Logs sem informa√ß√µes sens√≠veis
- Usar HTTPS em todas as comunica√ß√µes

## üìö Recursos de Aprendizado

### Documenta√ß√£o Oficial
- [Spring Boot Docs](https://spring.io/projects/spring-boot)
- [Firebase Admin SDK](https://firebase.google.com/docs/admin/setup)
- [Firebase Auth](https://firebase.google.com/docs/auth)
- [Firestore](https://firebase.google.com/docs/firestore)
- [Kotlin Docs](https://kotlinlang.org/docs/home.html)
- [Android Developers](https://developer.android.com)

## üéì Contexto Acad√™mico

- **Institui√ß√£o**: IFRS - Instituto Federal do Rio Grande do Sul
- **Campus**: Porto Alegre
- **Curso**: T√©cnico/Tecn√≥logo em Inform√°tica
- **Tipo**: Trabalho de Conclus√£o de Curso (TCC)
- **Per√≠odo**: 2024/2025
- **√Årea**: Desenvolvimento de Sistemas / Engenharia de Software

## üí° Pr√≥ximas Funcionalidades (Roadmap)

1. **Notifica√ß√µes Push** no app mobile
2. **Dashboard de m√©tricas** para administradores
3. **Relat√≥rios em PDF** de evolu√ß√£o dos alunos
4. **Integra√ß√£o com wearables** (opcional)
5. **Sistema de agendamento** de hor√°rios
6. **Chat** entre aluno e professor
7. **Gamifica√ß√£o** com conquistas e badges
8. **Suporte a m√∫ltiplas academias** (multi-tenant)

## ü§î Decis√µes de Design

### Por que Firebase?
- Facilita autentica√ß√£o
- NoSQL flex√≠vel para modelo de dados
- Real-time updates gratuitos
- SDK bem documentado
- Escal√°vel automaticamente

### Por que Spring Boot?
- Framework maduro e robusto
- √ìtima integra√ß√£o com Firebase
- Spring Security poderoso
- Grande comunidade
- Facilita testes

### Por que Kotlin?
- Linguagem moderna e concisa
- Recomendada pelo Google para Android
- Null-safety nativa
- Coroutines para c√≥digo ass√≠ncrono limpo
- Interoper√°vel com Java

## üìû Informa√ß√µes de Contato e Suporte

- **GitHub**: [marloncm/MovimentaIF](https://github.com/marloncm/MovimentaIF)
- **Email**: marlon.cmariano93@gmail.com
- **Issues**: Use GitHub Issues para reportar bugs
- **Wiki**: Documenta√ß√£o adicional no GitHub Wiki

---

**√öltima atualiza√ß√£o**: Novembro 2025  
**Vers√£o da API**: 1.0.0  
**Status**: Em desenvolvimento ativo
