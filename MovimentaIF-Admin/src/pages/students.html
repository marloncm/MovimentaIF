<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MovimentaIF - Gerenciar Alunos</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chosen Palette: Academic Green & Neutral Gray -->
    <!-- Application Structure Plan: A dedicated page for managing student data. It shares the same sidebar-main content layout as the dashboard and workouts page for a consistent and intuitive user experience. The page displays student data in a clear, searchable, and sortable table, which is a standard UI pattern for data management. It also features a button to add new students and simulated action buttons for editing and deactivating entries. This design prioritizes data clarity and ease of management. -->
    <!-- Visualization & Content Choices: Report Info: Need to manage student profiles. Goal: Enable professors to easily view and manage student information. Viz/Presentation Method: An HTML table is the optimal method for displaying structured student data (Name, Email, Status). Action buttons for each row allow for direct interaction. A search input provides filtering capabilities. Interaction: Users can search the table, click action buttons to perform operations, and use a button to open a form for adding new students (simulated). Justification: Tables are the most effective way to present and manipulate lists of records. They are familiar to users and facilitate data-driven tasks. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        .nav-link.active {
            background-color: #D1FAE5;
            /* bg-emerald-50 */
            color: #10B981;
            /* text-emerald-600 */
            font-weight: 600;
        }
    </style>
</head>

<body class="bg-slate-50 font-sans">

    <div class="flex h-screen bg-slate-100">
        <!-- Sidebar -->
        <aside class="w-64 bg-white shadow-md flex-shrink-0">
            <div class="p-6 border-b">
                <h1 class="text-2xl font-bold text-slate-800">MovimentaIF</h1>
            </div>
            <nav class="p-4">
                <a href="dashboard.html"
                    class="nav-link flex items-center p-3 text-slate-600 hover:bg-slate-50 rounded-lg">
                    <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6">
                        </path>
                    </svg>
                    Início
                </a>
                <a href="students.html"
                    class="nav-link flex items-center p-3 text-slate-700 bg-emerald-50 rounded-lg font-semibold mt-2">
                    <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z">
                        </path>
                    </svg>
                    Alunos
                </a>
                <a href="workouts.html"
                    class="nav-link flex items-center p-3 text-slate-600 hover:bg-slate-50 rounded-lg mt-2">
                    <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16v4m-2-2h4m5 10v4m-2-2h4M5 3a2 2 0 00-2 2v1m16 0V5a2 2 0 00-2-2h-1m-4 16l-3-3m0 0l-3 3m3-3v-6m0 6h.01M7 11h10M5 17a2 2 0 002 2h1m-4-16a2 2 0 012-2h1m4 16a2 2 0 002-2v-1m-4 4l3 3m0 0l3-3m-3 3v-6m0 6h-.01M17 11H7">
                        </path>
                    </svg>
                    Treinos
                </a>
                <a href="dashboard.html#agenda"
                    class="nav-link flex items-center p-3 text-slate-600 hover:bg-slate-50 rounded-lg mt-2">
                    <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z">
                        </path>
                    </svg>
                    Agenda
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- Header -->
            <header class="bg-white shadow-sm p-4 flex justify-between items-center">
                <h2 class="text-xl font-semibold text-slate-700">Gerenciar Alunos</h2>
                <div class="flex items-center">
                    <span id="user-email" class="text-slate-600 mr-4"></span>
                    <button id="logout-btn"
                        class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition">Sair</button>
                </div>
            </header>

            <!-- Content Area -->
            <main class="flex-1 overflow-x-hidden overflow-y-auto bg-slate-50 p-6">

                <div class="bg-white p-6 rounded-lg shadow">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold text-slate-800">Lista de Alunos</h3>
                        <button id="add-student-btn"
                            class="bg-emerald-600 text-white px-4 py-2 rounded-lg hover:bg-emerald-700 transition">Adicionar
                            Aluno</button>
                    </div>
                    <input type="text" id="search-input" placeholder="Buscar aluno por nome..."
                        class="w-full p-3 mb-4 border border-slate-300 rounded-lg">
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="bg-slate-50">
                                <tr>
                                    <th class="p-3 text-sm font-semibold text-slate-600">Nome</th>
                                    <th class="p-3 text-sm font-semibold text-slate-600">Email</th>
                                    <th class="p-3 text-sm font-semibold text-slate-600">Status</th>
                                    <th class="p-3 text-sm font-semibold text-slate-600">Ações</th>
                                </tr>
                            </thead>
                            <tbody id="students-table-body">
                                <!-- Dados dos alunos serão injetados aqui via JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAnET6gJ175qHFbHcKm40tynj7s9x4sXqU",
            authDomain: "movimentaif.firebaseapp.com",
            databaseURL: "https://movimentaif-default-rtdb.firebaseio.com",
            projectId: "movimentaif",
            storageBucket: "movimentaif.firebasestorage.app",
            messagingSenderId: "705983497984",
            appId: "1:705983497984:web:f16672db437ce21aa2d5e5",
            measurementId: "G-5K2CYJ742W"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        const userEmailSpan = document.getElementById('user-email');
        const logoutBtn = document.getElementById('logout-btn');
        const searchInput = document.getElementById('search-input');
        const studentsTableBody = document.getElementById('students-table-body');

        // onAuthStateChanged(auth, user => {
        //     if (user) {
        //         userEmailSpan.textContent = user.email;
        //     } else {
        //         window.location.replace('index.html');
        //     }
        // });

        logoutBtn.addEventListener('click', () => {
            signOut(auth).then(() => {
                console.log("Logout bem-sucedido.");
            }).catch((error) => {
                console.error("Erro no logout:", error);
            });
        });

        const students = [
            { id: 1, nome: "Ana Silva", email: "ana.silva@aluno.ifrs.edu.br", status: "Ativo" },
            { id: 2, nome: "Bruno Costa", email: "bruno.costa@aluno.ifrs.edu.br", status: "Ativo" },
            { id: 3, nome: "Carlos Dias", email: "carlos.dias@aluno.ifrs.edu.br", status: "Inativo" },
            { id: 4, nome: "Daniela Pereira", email: "daniela.pereira@aluno.ifrs.edu.br", status: "Ativo" },
            { id: 5, nome: "Eduardo Souza", email: "eduardo.souza@aluno.ifrs.edu.br", status: "Inativo" }
        ];

        function renderStudents(filterText = '') {
            studentsTableBody.innerHTML = '';
            const filteredStudents = students.filter(student =>
                student.nome.toLowerCase().includes(filterText.toLowerCase())
            );

            filteredStudents.forEach(student => {
                const row = document.createElement('tr');
                row.className = 'border-b';

                const statusColor = student.status === 'Ativo' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700';
                const actionButton = student.status === 'Ativo' ?
                    `<button class="text-red-500 hover:underline deactivate-btn" data-id="${student.id}">Desativar</button>` :
                    `<button class="text-emerald-500 hover:underline activate-btn" data-id="${student.id}">Ativar</button>`;

                row.innerHTML = `
                    <td class="p-3">${student.nome}</td>
                    <td class="p-3">${student.email}</td>
                    <td class="p-3"><span class="px-2 py-1 rounded-full text-xs ${statusColor}">${student.status}</span></td>
                    <td class="p-3 space-x-2">
                        <button class="text-blue-500 hover:underline edit-btn" data-id="${student.id}">Editar</button>
                        ${actionButton}
                    </td>
                `;
                studentsTableBody.appendChild(row);
            });
            attachEventListeners();
        }

        function attachEventListeners() {
            document.querySelectorAll('.deactivate-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const id = parseInt(e.target.dataset.id);
                    const student = students.find(s => s.id === id);
                    if (student) student.status = 'Inativo';
                    renderStudents(searchInput.value);
                });
            });

            document.querySelectorAll('.activate-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const id = parseInt(e.target.dataset.id);
                    const student = students.find(s => s.id === id);
                    if (student) student.status = 'Ativo';
                    renderStudents(searchInput.value);
                });
            });

            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const id = parseInt(e.target.dataset.id);
                    const student = students.find(s => s.id === id);
                    alert(`Simulando edição do aluno: ${student.nome}`);
                });
            });

            document.getElementById('add-student-btn').addEventListener('click', () => {
                alert('Simulando a adição de um novo aluno...');
            });
        }

        searchInput.addEventListener('input', (e) => {
            renderStudents(e.target.value);
        });

        renderStudents();
    </script>
</body>

</html>